# [Четные числа Фибоначчи](https://www.codewars.com/kata/5926624c9b424d10390000bf/python)

## [Проблема](https://euler.jakumo.org/problems/view/2.html)

> Каждый следующий элемент ряда Фибоначчи получается при сложении двух предыдущих. Начиная с 1 и 2, первые 10 элементов будут:
>
> 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
>
> Найдите сумму всех четных элементов ряда Фибоначчи, которые не превышают n

``` python
solution (34) # => 44 = 2 + 8 + 34
solution (10) # => 10 = 2 + 8
solution (15) # => 10 = 2 + 8
solution (2) # => 2
```

## Частное решение (1)

- найти кратные 3 и 5, вплоть до входного числа
- суммировать полученный набор чисел

```python
def solution(n):
    i, j = 1, 2
    result_sum = 0
    while j <= n:
        if j % 2 == 0:
            result_sum += j
        i, j = j, i + j
    return result_sum
```
``` text

  №     Время  Замедление                       Число                Результат
---  --------  ------------  ------------------------  -----------------------
  1  1.1e-05   0.001%           100000000000000000000     67650926172353373024
  2  1.3e-05   0.00%           1000000000000000000000   1213946614199987541226
  3  1.36e-05  0.00%          10000000000000000000000   5142360378806858706956
  4  1.41e-05  0.00%         100000000000000000000000  92275912896516548183166
```
*[-] Проходит все числа до N*, эффективнее было-бы проскакивать ненужные числа.
Поэтому более эффективный подход будет опираться на законамерность.

## Частное решение (2)

Возьмём массив чётных чисел из ряда 
```text
[0, 2, 8, 34, 144, 610, 2584, 10946, 46368, 196418, 832040] (это чётные числа < 1_000_000)
```

Если поставить в начало 0, то `(8 = 2*4+0)`,  `(34 = 8*4+2)`

`4 * b + a`. Я уверен, что есть математическая формула, чтобы восстановить этот паттерн, но я буду принимать его как данность.
Используя эти значения, можно практически рассматривать каждое кратное 2 только один раз. 

```python
def solution(n):
    if n <= 1: return 0
    a, b = 0, 2
    result_sum = 0
    while 4 * b + a <= n:
        a, b = b, 4 * b + a
        result_sum += a
    return result_sum + b
```
``` text
  №     Время  Замедление                       Число                Результат
---  --------  ------------  ------------------------  -----------------------
  1  7.1e-06   0.001%           100000000000000000000     67650926172353373024
  2  7.5e-06   0.00%           1000000000000000000000   1213946614199987541226
  3  7.6e-06   0.00%          10000000000000000000000   5142360378806858706956
  4  8.e-06    0.00%         100000000000000000000000  92275912896516548183166
```

## Общее решение (1)

```python
import math
from decimal import Decimal, getcontext
    
def solution(n):
    getcontext().prec = 100
    phi = (Decimal(5) ** Decimal(0.5) + 1) / Decimal(2)
    index = (math.floor(math.log(n * (phi + 2), phi) - 1) // 3) * 3 + 2
    num = Decimal(round(phi ** Decimal(index + 1))) / (phi + 2)
    sum = num // 2
    return int(sum)
```
```text
  №     Время  Замедление                       Число                Результат
---  --------  ------------  ------------------------  -----------------------
  1  1.4e-06   0.001%           100000000000000000000     67650926172353373024
  2  1.5e-06  -0.001%          1000000000000000000000   1213946614199987541226
  3  1.6e-06   0.00%          10000000000000000000000   5142360378806858706956
  4  1.5e-06   0.00%         100000000000000000000000  92275912896516548183166
```