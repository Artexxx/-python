# [Сложение простых чисел](https://www.codewars.com/kata/59ab0ca4243eae9fec000088/train/python)

## [Проблема](https://euler.jakumo.org/problems/view/10.html)

>Сумма простых чисел меньше 10 равна 2 + 3 + 5 + 7 = 17.
>
>Найдите сумму всех простых чисел меньше `n`.

*Решение должно работать для действительно больших чисел (более 10 000 000).*


``` python
solution(7) # => 10 = 2 + 3 + 5
solution(10) # => 17 = 2 + 3 + 5 + 7
solution(10 000) # => 5736396
solution(1 000 000) # => 37550402023
solution(2 000 000) # => 142913828922
```

## Частное решение (1)

``` python
def is_prime(n):
    if n == 2:
        return True
    elif n % 2 == 0:
        return False
    else:
        for i in range(3, int(sqrt(n)) + 1, 2):
            if n % i == 0: return False
    return True


def sum_of_primes(n):
    if n > 2: sumOfPrimes = 2
    else: return 0
    for candidate in range(3, n, 2):
        if is_prime(candidate):
            sumOfPrimes += candidate
    return sumOfPrimes
```
```text
  №       Время  Замедление        Число     Результат
---  ----------  ------------    -------  ------------
  1   0.0051545  0.515%          10000         5736396
  2   0.0862083  8.11%          100 000      454396537
  3   1.90828    182.21%       1 000 000   37550402023
  4  18.3567     1644.84%      5 000 000  838596693108
```

## Частное решение (2)

- *Решето Эратосфена* - один из самых эффективных способов найти все простые числа меньше n, когда n меньше 10 миллионов.

<img src="https://github.com/karimelgazar/Project-Euler/blob/master/010%20Summation%20of%20primes/way.gif?raw=true" alt="Eratosfen gif 2 ">

> ### Пример для n = 30 ###
> Запишем натуральные числа, начиная от `2`, до `30` в ряд:
>
> *2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30*
>
> Первое число в списке, `2` — простое. Пройдём по ряду чисел, зачёркивая все числа, кратные 2 (то есть, каждое второе, начиная с `2*2 = 4`):
>
>*2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30*
>
>Следующее незачеркнутое число, `3` — простое. Пройдём по ряду чисел, зачёркивая все числа, кратные 3 (то есть, каждое третье, начиная с `3*3 = 9`):
>
>*2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30*
>
>Следующее незачеркнутое число, `5` — простое. Пройдём по ряду чисел, зачёркивая все числа, кратные 5 (то есть, каждое пятое, начиная с `5*5 = 25`):
>
>*2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30*
>
>Следующее незачеркнутое число — `7`. Его квадрат, 49 — больше 30, поэтому на этом работа завершена. Все составные числа уже зачеркнуты:
>
>*2  3     5     7           11    13          17    19          23                29*
```python

def bit_sieve(n) -> list:
    ''' Решето Эратосфена.
    В списке bits сбрасываются биты, имеющие составные номера, биты с простыми номерами == 1.
    i-му по порядку элементу будет соответствовать 1, если i -- простое и 0 иначе.

    Сложность: nloglog(n).
    '''
    bits = [1] * (n + 1)
    for index in range(2, int(math.sqrt(n))):
        if bits[index]:  # если i -- простое
            for j in range(index * index, n + 1, index):  # занулить все ему кратные
                bits[j] = 0
    return bits


def bit_sieve_optimized(n) -> list:
    """ Оптимизированное Решето Эратосфена. """
    primes = [True] * n
    primes[0], primes[1] = False, False  # числа 0 and 1

    number_of_multiples = len(primes[4::2])
    primes[4::2] = [False] * number_of_multiples

    for p in range(3, int(math.sqrt(n)) + 1, 2):
        if primes[p]:
            number_of_multiples = len(primes[p * p::p * 2])
            primes[p * p::p * 2] = [False] * number_of_multiples  # занулить все ему кратные
    return primes

def prime_sum(n: int) -> int:
    list_of_primality = bit_sieve(n)
    return sum((i for (i, isprime) in enumerate(list_of_primality) if isprime))
```
```text
 №1      Время  Замедление       Число         Результат
---  ---------  ------------  --------    --------------
  1  0.0113791  1.138%          10 0000        454396538
  2  0.130103   11.87%         1 000 000     37550402024
  3  1.57068    144.06%       10 000 000   3203324994357
  4  8.45341    688.27%       50 000 000  72619548630278

 №2      Время  Замедление       Число       Результат
---  ---------  ------------  --------  --------------
  1  0.0055752  0.558%          100000       454396537
  2  0.0673298  6.18%          1000000     37550402023
  3  0.923934   85.66%        10000000   3203324994356
  4  4.993      406.91%       50000000  72619548630277
```
